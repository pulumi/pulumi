{
  // Everything requires triggering via the dependency dashboard, except:
  // * security updates
  // * first party (aka pulumi) packages
  // * pinning of all dependencies in test projects, devDependencies in library code, github actions tags,
  //   ie actions/checkout@v4 -> actions/checkout@34e114876b0b11c390a56381ad16ebd13914f8d5 # v4
  $schema: "https://docs.renovatebot.com/renovate-schema.json",
  extends: [
    "github>pulumi/renovate-config//default.json5"
  ],
  // TODO: Remove baseBranches and useBaseBranchConfig settings once we're happy with the configuration
  baseBranches: ["renovate-dev"],
  useBaseBranchConfig: "merge",
  enabledManagers: [
    // Go
    "gomod",

    // Node
    "npm",

    // Python
    "pip_requirements",
    "pip_setup",
    "poetry",
    // uv.lock support
    "pep621",

    // GitHub
    "github-actions",
  ],
  // The preset's ignorePaths has `sdk/**` in it, we don't want that
  // https://github.com/pulumi/renovate-config/blob/main/default.json5#L55
  ignorePaths: [
    "**/node_modules/**",
    // Ignore package files generated by codegen and language conformance tests
    "sdk/go/pulumi-language-go/testdata/**",
    "sdk/python/cmd/pulumi-language-python/testdata/**",
    "sdk/nodejs/cmd/pulumi-language-nodejs/testdata/**",
    "tests/testdata/codegen/**",
    "pkg/codegen/testing/test/**",
  ],
  // Override for https://github.com/pulumi/renovate-config/blob/main/default.json5#L89
  // TODO: just for now, while developing, we probably want to have this on `false` so security PRs are created automatically
  vulnerabilityAlerts: {
    dependencyDashboardApproval: true,
  },
  packageRules: [
    // Don't propose updates for packages that are less than 3 days old. Security vulnerabilities bypass this setting.
    {
      matchDatasources: ["npm", "pypi", "go"],
      minimumReleaseAge: "3 days",
      prCreation: "not-pending"
    },
    // Disable auto-update for pulumi/pulumi - our base config auto-updates first party packages, but we don't want
    // this for dependencies that come from this repo, i.e. don't update the core SDK in tests.
    {
      matchManagers: ["gomod"],
      matchPackageNames: ["github.com/pulumi/pulumi/**"],
      enabled: false
    },
    {
      matchManagers: ["npm"],
      matchPackageNames: ["@pulumi/pulumi"],
      enabled: false
    },
    {
      matchManagers: ["pep621"],
      matchPackageNames: ["pulumi"],
      enabled: false
    },
    // Pin all test dependencies
    // https://github.com/pulumi/renovate-config/blob/5a711294b6b86c30f210802d7dc5b7bdbadd8629/default.json5#L131-L139
    {
      matchPackageNames: ["*"],
      matchFileNames: ["tests/**", "sdk/python/lib/test/**", "sdk/nodejs/tests/**", "sdk/go/auto/test/**"],
      rangeStrategy: "pin"
    },
    // Don't update requires-python in pyproject.toml files, we need the test projects to be installable in a range of Python versions
    {
      matchDatasources: ["python-version"],
      enabled: false
    },
    // Don't update the python version in poetry dependencies in test pyproject.toml files, we need the test projects to be installable in a range of Python versions
    {
      matchDepTypes: ["dependencies"],
      matchManagers: ["poetry"],
      matchPackageNames: ["python"],
      enabled: false
    }
  ]
}
