{
  $schema: "https://docs.renovatebot.com/renovate-schema.json",
  extends: [
    "github>pulumi/renovate-config//default.json5"
  ],
  enabledManagers: [
    // Go
    "gomod",

    // Node
    "npm",

    // Python
    "pip_requirements",
    "pip_setup",
    "pep621",
    // We don't want to update poetry pyproject.toml files. This is currently updating the `python` version in `tool.poetry.dependencies`, likely a bug in our current renovate version.
    // "poetry"

    // GitHub
    "github-actions",
  ],
  // The preset's ignorePaths has `sdk/**` in it, we don't want that
  // https://github.com/pulumi/renovate-config/blob/main/default.json5#L55
  ignorePaths: [
    "**/node_modules/**",
    // Ignore package files generated by codegen and language conformance tests
    "sdk/go/pulumi-language-go/testdata/**",
    "sdk/python/cmd/pulumi-language-python/testdata/**",
    "sdk/nodejs/cmd/pulumi-language-nodejs/testdata/**",
    "tests/testdata/codegen/**",
    "pkg/codegen/testing/test/**",
  ],
  packageRules: [
    {
      description: "Pin all test dependencies",
      matchPackageNames: ["*"],
      matchFileNames: ["tests/**", "sdk/python/lib/test/**", "sdk/nodejs/tests/**", "sdk/go/auto/test/**"],
      rangeStrategy: "pin"
    },
    {
      description: "Don't propose updates for packages that are less than 3 days old. Security vulnerabilities bypass this setting.",
      matchDatasources: ["npm", "pypi", "go"],
      minimumReleaseAge: "3 days",
      prCreation: "not-pending"
    },
    {
      description: "Don't update requires-python in pyproject.toml files, we want to run against the full range of supported Python versions.",
      matchDatasources: ["python-version"],
      enabled: false
    },
    {
      // This does not seem to be working, `poetry` is disabled in `enabledManagers` above for now
      description: "Don't update the python version in poetry dependencies in pyproject.toml files, we want to run against the full range of supported Python versions, override from base company config",
      matchManagers: ["poetry"],
      matchPackageNames: ["python"],
      enabled: false
    },
    {
      description: "Disable auto-update for first party packages",
      matchDatasources: ["go", "npm", "pypi"],
      matchPackageNames: [
        "github.com/pulumi/**",
        "@pulumi/**",
        "pulumi",
        "pulumi-**",
      ],
      enabled: false
    },
    {
      description: "Auto-update esc",
      matchDatasources: ["go"],
      matchPackageNames: [
        "github.com/pulumi/esc",
      ],
      enabled: true
    },
    {
      description: "Disable updating for tests that trip up renovate",
      matchFileNames: [
        // Uses `pulumi package add`
        // github.com/my-namespace/pulumi-mypkg/sdk/go/mypkg: cannot find module providing package github.com/my-namespace/pulumi-mypkg/sdk/go/mypkg
        "tests/integration/package-add/namespace/go/**",
        // Fails to find file for replace:
        // Command failed: go get -d -t ./...
        // go: -d flag is deprecated. -d=true is a no-op
        // go: github.com/pulumi/pulumi/tests/testdata/codegen/methods-return-plain-resource/go@v0.0.0 (replaced by ../../../testdata/codegen/methods-return-plain-resource/go): reading ../../../testdata/codegen/methods-return-plain-resource/go/go.mod: open /tmp/renovate/repos/github/pulumi/pulumi/tests/testdata/codegen/methods-return-plain-resource/go/go.mod: no such file or directory
        "tests/integration/construct_component_configure_provider/go/**"
      ],
      enabled: false
    },
  ]
}
